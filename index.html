<!DOCTYPE html>
<html>
<head>
	<title>GAsp_v3</title>
	<meta charset="utf-8">
	<link rel="stylesheet" type="text/css" href="./css/index.css">
	<script type="text/javascript" src="./js/lib/ganja.js"></script>
	<script type="text/javascript" src="./js/classes.js"></script>
</head>
<body>
	<nav>
		<h1>GAsp <span>a web GA manipulator</span></h1>
	</nav>
	<section id="mainPart">
		<div id="leftPanel">
			<div id="selectLeftPan">
				<p class="active">JS</p>
				<p>OBJECT MODE</p>
			</div>
			<div id="leftContent">
				
			</div>
		</div>
		<div id="viewer">
			<!--<div id="newProject">
				<div id="npSub">	
					<img src="./media/img/new-document.png">
					<p>Create a new project</p>
				</div>
			</div>-->	
		</div>
		<div id="run">Run</div>
	</section>

	<script src="./js/lib/ace/ace.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript" id="ganjaCode"></script>
	<script>

		//ACE EDITOR (CONSOLE)
		aceEditor = () => {
			if (window.ace) {
			    var editor = ace.edit("leftContent");
			    editor.setTheme("ace/theme/tomorrow"); //theme setters 
			    editor.session.setMode("ace/mode/javascript"); //mode = js, php etc...
		     	editor.resize();
		     	return editor;
		    } else { // can't load ace editor
		      	console.log("Can't load Ace editor");
		    }
		}
		editor = aceEditor();
	    editor.setValue(""); //Fill the editor with current ganja code

	    sizeCanvas = () => {
		//CANVAS SIZE
			var viewer = document.getElementById("viewer");
		    var present = viewer.querySelector("svg")||viewer.querySelector("canvas");
		    if (present || present.value){ 
		    	present.style.width= "100%";  	
		    	present.style.height = document.getElementById("leftPanel").offsetHeight+"px";
		    }
		};

	    //Modals Creation

	    const modalCreate = new Modal("Create a project");
	    modalCreate.content = "<form method='post' action=''><label for='name'>Project Name (20 characters MAX): </label><input type='text' name='name'><label for='ga'>Project description: </label><textarea></textarea><label for='ga'>Select your GA: </label><select name='ga'><option>GA 1</option></select></form>";
	    modalCreate.footer = "<input type='submit' value='Create'>";

	    //Event Listener

		/*document.getElementById("newProject").onclick = () =>{
			modalCreate.display();
		}*/



		//EVENTS LISTENER ON CONSOLE 
	    editor.session.on('change', function(delta) {
			// delta.start, delta.end, delta.lines, delta.action
			if(delta.action=="insert" || delta.action=="remove"){
				document.getElementById("run").classList.add("active");
			}
		});


		//EVENT CLICK RUN 
		document.getElementById("run").onclick=() =>{
			var currentCode = editor.getValue();
			document.getElementById("viewer").innerHTML = "";
			var scriptGJ = document.getElementById("ganjaCode");
			scriptGJ.parentNode.removeChild(scriptGJ);
			var script= document.createElement('script');
     		script.id= 'ganjaCode';
     		script.innerHTML = currentCode;
     		document.body.appendChild(script);
			document.getElementById("run").classList.remove("active");
			sizeCanvas();
		}


	// 	sizeCanvas = () => {
	// 	  	//CANVAS SIZE
	// 		var viewer = document.getElementById("viewer");
	// 	    var present = viewer.querySelector("svg")||viewer.querySelector("canvas");
	// 	    if (present || present.value){ 
	// 	    	present.style.width= "100%";  	
	// 	    	present.style.height = document.getElementById("page").offsetHeight+"px";
	// 	    }
	// 	};
		
	// 	sizeCanvas();
	// 	//DISPLAY ALGEBRA INFOS
	// 	dispMetrics = () =>{
	// 		var datas = Algebra(2,0,1).describe();

	// 		var table = document.createElement('table');
	// 		table.id="basisMetric";
	// 		var caption = document.createElement('caption');
	// 		caption.innerHTML = "Basis/Metrics";
	// 		table.appendChild(caption);
	// 		var tbdy = document.createElement('tbody');
	// 		for (var i = 0; i < 2; i++) {
	// 		    var tr = document.createElement('tr');
	// 		    for (var j = 0; j < datas.basis.length; j++) {
	// 		        var td = document.createElement('td');
	// 		        if(i==0)
	// 		       	 	td.appendChild(document.createTextNode(datas.basis[j]));
	// 		       	else
	// 		       		td.appendChild(document.createTextNode(datas.metric[j]));
	// 		        tr.appendChild(td)
	// 		    }
	// 		    tbdy.appendChild(tr);
	// 		  }
	// 		  table.appendChild(tbdy);
	// 		document.getElementById("gaDetails").appendChild(table);
	// 	}

	// 	dispMultTable = () =>{
	// 		var datas = Algebra(2,0,1).describe();

	// 		var table = document.createElement('table');
	// 		table.id="multTable";
	// 		var caption = document.createElement('caption');
	// 		caption.innerHTML = "multTable";
	// 		table.appendChild(caption);
	// 		var tbdy = document.createElement('tbody');
	// 		for (var i = 0; i < datas.mulTable[0].length; i++) {
	// 		    var tr = document.createElement('tr');
	// 		    for (var j = 0; j < datas.mulTable.length; j++) {
	// 		        var td = document.createElement('td');
	// 		       	td.appendChild(document.createTextNode(datas.mulTable[i][j]));
	// 		        tr.appendChild(td)
	// 		    }
	// 		    tbdy.appendChild(tr);
	// 		  }
	// 		  table.appendChild(tbdy);
	// 		document.getElementById("gaDetails").appendChild(table);
	// 	}
	// 	dispGaDetails = () =>{
	// 		dispMetrics();
	// 		dispMultTable();
	// 	}

 // 		dispGaDetails();
 // 		//Scalable sections
	// 	document.getElementById("movableLeft").onmousedown=(e) =>{dragH = 1;}
	// 	document.getElementById("movableLeft").onmouseup=(e) =>{dragH = 0;}

	// 	document.getElementById("movableVert").onmousedown=(e) =>{dragV = 1;}
	// 	document.getElementById("movableVert").onmouseup=(e) =>{dragV = 0;}


	// 	document.getElementsByTagName('body')[0].onmousemove = (e) =>{
	// 		if(dragH){
	// 			var zb = (document.getElementById("infosLeft").offsetWidth);
	// 			var width = window.innerWidth - zb;
	// 			var pourc = ((e.clientX-zb)*100)/width;
	// 			var gTP = (pourc)+"%"+(100-(pourc))+"%";
	// 			document.getElementById("page").style.gridTemplateColumns= gTP;
	// 		}
	// 		/*if(dragV){
	// 			var zb = (document.getElementById("pageSelection").offsetHeight);
	// 			var height = window.innerHeight - zb;
	// 			var pourc = ((e.clientY-zb)*100)/height;
	// 			var gTR = (pourc)+"%"+(100-(pourc))+"%";
	// 			document.getElementById("leftBoxes").style.gridTemplateRows= gTR;
	// 		}*/
	// 	};

	//     //EVENTS LISTENER ON CONSOLE 
	//     editor.session.on('change', function(delta) {
	// 		// delta.start, delta.end, delta.lines, delta.action
	// 		if(delta.action=="insert" || delta.action=="remove"){
	// 			document.getElementById("run").classList.add("active");
	// 		}
	// 	});

	// 	//EVENT CLICK RUN 
	// 	document.getElementById("run").onclick=() =>{
	// 		var currentCode = editor.getValue();
	// 		document.getElementById("viewer").innerHTML = "";
	// 		var scriptGJ = document.getElementById("ganjaCode");
	// 		scriptGJ.parentNode.removeChild(scriptGJ);
	// 		var script= document.createElement('script');
 //     		script.id= 'ganjaCode';
 //     		script.innerHTML = currentCode;
 //     		document.body.appendChild(script);
	// 		document.getElementById("run").classList.remove("active");
	// 		sizeCanvas();
	// 	}

	// 	document.getElementById("changeMode").onclick = () =>{
	// 		var leftBoxes = document.getElementById("leftBoxes");
	// 		switch(stateMode){
	// 			case 0:
	// 				stateMode = 1;
	// 				leftBoxes.classList.remove("active");
	// 				leftBoxes.style.width = "0px";
	// 				document.getElementById("page").style.gridTemplateColumns= "0% 100%";
	// 				break;
	// 			case 1:
	// 				stateMode = 0;
	// 				leftBoxes.classList.add("active");
	// 				leftBoxes.style.width = "auto";
	// 				document.getElementById("page").style.gridTemplateColumns= "40% 60%";
 // 					dispGaDetails();
	// 				break;
	// 		}
	// 	}
	// 	document.body.onkeydown = (e)=>{
	// 	    if(e.keyCode==27){ //Escape
	// 	    	dragV = dragH = 0;
	// 	    }
	// 	};
	</script>
</body>
</html>